2025-09-26 09:22:12.921 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 09:22:13.306 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 09:22:13.332 +05:30 [INF] Hosting environment: Development
2025-09-26 09:22:13.337 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 09:22:15.698 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 09:22:16.496 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 180.5455 ms
2025-09-26 09:22:16.522 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 838.183ms
2025-09-26 09:22:16.557 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 09:22:16.611 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 09:22:16.633 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 78.8204ms
2025-09-26 09:22:16.818 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 207.5049ms
2025-09-26 09:22:16.922 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 09:22:17.000 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 52.6330 ms
2025-09-26 09:22:17.018 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 95.1558ms
2025-09-26 09:26:16.323 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 186
2025-09-26 09:26:16.333 +05:30 [WRN] Failed to determine the https port for redirect.
2025-09-26 09:26:16.337 +05:30 [INF] CORS policy execution successful.
2025-09-26 09:26:16.386 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 09:26:16.391 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 09:26:16.447 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 09:26:22.888 +05:30 [INF] Executed DbCommand (316ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Campaign] ([EndDate], [Name], [StartDate], [StoreList], [TargetProducts])
OUTPUT INSERTED.[CampaignID]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 09:26:23.007 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 09:26:23.044 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 6587.9643ms
2025-09-26 09:26:23.048 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 09:26:23.050 +05:30 [INF] Request processed successfully.
2025-09-26 09:26:23.052 +05:30 [INF] HTTP POST /api/Campaign/plan responded 201 in 6724.0011 ms
2025-09-26 09:26:23.063 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 201 null application/json; charset=utf-8 6740.056ms
2025-09-26 09:26:44.912 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Campaign - null null
2025-09-26 09:26:44.953 +05:30 [INF] Processing request: /api/Campaign
2025-09-26 09:26:44.958 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 09:26:44.970 +05:30 [INF] Route matched with {action = "GetAllCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCampaigns() on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 09:26:45.604 +05:30 [INF] Executed DbCommand (18ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
2025-09-26 09:26:45.665 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PromoPilot.Application.DTOs.CampaignDto, PromoPilot.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-26 09:26:45.678 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API) in 697.9423ms
2025-09-26 09:26:45.686 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 09:26:45.692 +05:30 [INF] Request processed successfully.
2025-09-26 09:26:45.696 +05:30 [INF] HTTP GET /api/Campaign responded 200 in 759.9157 ms
2025-09-26 09:26:45.702 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Campaign - 200 null application/json; charset=utf-8 790.0674ms
2025-09-26 09:27:11.693 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Campaign/15 - null null
2025-09-26 09:27:11.709 +05:30 [INF] Processing request: /api/Campaign/15
2025-09-26 09:27:11.710 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.GetCampaignById (PromoPilot.API)'
2025-09-26 09:27:11.721 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCampaignById(Int32) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 09:27:11.990 +05:30 [INF] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 09:27:12.015 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 09:27:12.019 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.GetCampaignById (PromoPilot.API) in 291.7929ms
2025-09-26 09:27:12.025 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.GetCampaignById (PromoPilot.API)'
2025-09-26 09:27:12.028 +05:30 [INF] Request processed successfully.
2025-09-26 09:27:12.030 +05:30 [INF] HTTP GET /api/Campaign/15 responded 200 in 321.7739 ms
2025-09-26 09:27:12.035 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Campaign/15 - 200 null application/json; charset=utf-8 342.6085ms
2025-09-26 09:28:36.643 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/15 - application/json 213
2025-09-26 09:28:36.657 +05:30 [INF] CORS policy execution successful.
2025-09-26 09:28:36.659 +05:30 [INF] Processing request: /api/Campaign/15
2025-09-26 09:28:36.663 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 09:28:36.675 +05:30 [INF] Route matched with {action = "UpdateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCampaign(Int32, PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 09:28:36.722 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 09:28:36.740 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 09:28:36.745 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 09:28:36.748 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API) in 66.5841ms
2025-09-26 09:28:36.752 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 09:28:36.754 +05:30 [INF] Request processed successfully.
2025-09-26 09:28:36.755 +05:30 [INF] HTTP PUT /api/Campaign/15 responded 200 in 98.7128 ms
2025-09-26 09:28:36.758 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/15 - 200 null application/json; charset=utf-8 115.0048ms
2025-09-26 09:29:32.602 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/schedule/15 - application/json 16
2025-09-26 09:29:32.621 +05:30 [INF] CORS policy execution successful.
2025-09-26 09:29:32.623 +05:30 [INF] Processing request: /api/Campaign/schedule/15
2025-09-26 09:29:32.626 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API)'
2025-09-26 09:29:32.634 +05:30 [INF] Route matched with {action = "ScheduleCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ScheduleCampaign(Int32, System.String) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 09:29:32.666 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-26 09:29:32.719 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API) in 80.0597ms
2025-09-26 09:29:32.724 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API)'
2025-09-26 09:29:32.725 +05:30 [INF] Request processed successfully.
2025-09-26 09:29:32.726 +05:30 [INF] HTTP PUT /api/Campaign/schedule/15 responded 400 in 105.7855 ms
2025-09-26 09:29:32.728 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/schedule/15 - 400 null application/problem+json; charset=utf-8 125.7496ms
2025-09-26 10:04:10.686 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/schedule/15 - application/json 15
2025-09-26 10:04:10.716 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:04:10.724 +05:30 [INF] Processing request: /api/Campaign/schedule/15
2025-09-26 10:04:10.730 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API)'
2025-09-26 10:04:10.739 +05:30 [INF] Route matched with {action = "ScheduleCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ScheduleCampaign(Int32, System.String) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:04:10.803 +05:30 [INF] Executed DbCommand (20ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:04:10.820 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:04:10.840 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:04:10.844 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API) in 97.7647ms
2025-09-26 10:04:10.849 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API)'
2025-09-26 10:04:10.853 +05:30 [INF] Request processed successfully.
2025-09-26 10:04:10.856 +05:30 [INF] HTTP PUT /api/Campaign/schedule/15 responded 200 in 140.3948 ms
2025-09-26 10:04:10.859 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/schedule/15 - 200 null application/json; charset=utf-8 173.1824ms
2025-09-26 10:09:34.382 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 10:09:34.638 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 10:09:34.645 +05:30 [INF] Hosting environment: Development
2025-09-26 10:09:34.649 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 10:09:36.193 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 10:09:36.634 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 98.8385 ms
2025-09-26 10:09:36.650 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 10:09:36.650 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 10:09:36.674 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 481.2537ms
2025-09-26 10:09:36.679 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 29.7451ms
2025-09-26 10:09:36.732 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 82.4924ms
2025-09-26 10:09:36.785 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 10:09:36.824 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 32.5373 ms
2025-09-26 10:09:36.830 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 45.5307ms
2025-09-26 10:09:56.382 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/schedule/15 - application/json 14
2025-09-26 10:09:56.398 +05:30 [WRN] Failed to determine the https port for redirect.
2025-09-26 10:09:56.402 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:09:56.451 +05:30 [INF] Processing request: /api/Campaign/schedule/15
2025-09-26 10:09:56.462 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API)'
2025-09-26 10:09:56.534 +05:30 [INF] Route matched with {action = "ScheduleCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ScheduleCampaign(Int32, System.String) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:10:03.634 +05:30 [INF] Executed DbCommand (238ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:10:03.967 +05:30 [INF] Executed DbCommand (26ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Campaign] SET [StoreList] = @p0
OUTPUT 1
WHERE [CampaignID] = @p1;
2025-09-26 10:10:03.997 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:10:04.017 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API) in 7476.1493ms
2025-09-26 10:10:04.022 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API)'
2025-09-26 10:10:04.026 +05:30 [INF] Request processed successfully.
2025-09-26 10:10:04.029 +05:30 [INF] HTTP PUT /api/Campaign/schedule/15 responded 200 in 7637.0651 ms
2025-09-26 10:10:04.045 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/schedule/15 - 200 null application/json; charset=utf-8 7663.0723ms
2025-09-26 10:10:57.093 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 206
2025-09-26 10:10:57.102 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:10:57.107 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 10:10:57.112 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:10:57.128 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:10:57.332 +05:30 [INF] Executed DbCommand (17ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Campaign] ([EndDate], [Name], [StartDate], [StoreList], [TargetProducts])
OUTPUT INSERTED.[CampaignID]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 10:10:57.353 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:10:57.389 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 251.8505ms
2025-09-26 10:10:57.395 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:10:57.401 +05:30 [INF] Request processed successfully.
2025-09-26 10:10:57.406 +05:30 [INF] HTTP POST /api/Campaign/plan responded 201 in 305.1336 ms
2025-09-26 10:10:57.412 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 201 null application/json; charset=utf-8 318.6183ms
2025-09-26 10:11:06.636 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 187
2025-09-26 10:11:06.645 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:11:06.648 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 10:11:06.650 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:11:06.652 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:11:06.765 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Campaign] ([EndDate], [Name], [StartDate], [StoreList], [TargetProducts])
OUTPUT INSERTED.[CampaignID]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 10:11:06.768 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:11:06.772 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 113.8995ms
2025-09-26 10:11:06.776 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:11:06.777 +05:30 [INF] Request processed successfully.
2025-09-26 10:11:06.779 +05:30 [INF] HTTP POST /api/Campaign/plan responded 201 in 134.5040 ms
2025-09-26 10:11:06.782 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 201 null application/json; charset=utf-8 145.7356ms
2025-09-26 10:11:20.551 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 187
2025-09-26 10:11:20.557 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:11:20.559 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 10:11:20.562 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:11:20.566 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:11:20.587 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Campaign] ([EndDate], [Name], [StartDate], [StoreList], [TargetProducts])
OUTPUT INSERTED.[CampaignID]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 10:11:20.593 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:11:20.598 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 23.8135ms
2025-09-26 10:11:20.603 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:11:20.608 +05:30 [INF] Request processed successfully.
2025-09-26 10:11:20.610 +05:30 [INF] HTTP POST /api/Campaign/plan responded 201 in 52.3334 ms
2025-09-26 10:11:20.616 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 201 null application/json; charset=utf-8 65.2621ms
2025-09-26 10:11:40.454 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Campaign/18 - null null
2025-09-26 10:11:40.471 +05:30 [INF] Processing request: /api/Campaign/18
2025-09-26 10:11:40.473 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.GetCampaignById (PromoPilot.API)'
2025-09-26 10:11:40.481 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCampaignById(Int32) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:11:40.498 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:11:40.502 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:11:40.503 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.GetCampaignById (PromoPilot.API) in 19.6562ms
2025-09-26 10:11:40.506 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.GetCampaignById (PromoPilot.API)'
2025-09-26 10:11:40.508 +05:30 [INF] Request processed successfully.
2025-09-26 10:11:40.509 +05:30 [INF] HTTP GET /api/Campaign/18 responded 200 in 41.0757 ms
2025-09-26 10:11:40.513 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Campaign/18 - 200 null application/json; charset=utf-8 58.3355ms
2025-09-26 10:13:00.117 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/18 - application/json 196
2025-09-26 10:13:00.133 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:13:00.134 +05:30 [INF] Processing request: /api/Campaign/18
2025-09-26 10:13:00.136 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:13:00.145 +05:30 [INF] Route matched with {action = "UpdateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCampaign(Int32, PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:13:00.156 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:13:00.179 +05:30 [INF] Executed DbCommand (17ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Campaign] SET [EndDate] = @p0, [Name] = @p1, [StartDate] = @p2, [StoreList] = @p3, [TargetProducts] = @p4
OUTPUT 1
WHERE [CampaignID] = @p5;
2025-09-26 10:13:00.185 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:13:00.188 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API) in 39.1183ms
2025-09-26 10:13:00.191 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:13:00.193 +05:30 [INF] Request processed successfully.
2025-09-26 10:13:00.194 +05:30 [INF] HTTP PUT /api/Campaign/18 responded 200 in 60.9408 ms
2025-09-26 10:13:00.197 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/18 - 200 null application/json; charset=utf-8 80.1143ms
2025-09-26 10:13:17.132 +05:30 [INF] Request starting HTTP/1.1 DELETE http://localhost:5145/api/Campaign/17 - null null
2025-09-26 10:13:17.142 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:13:17.144 +05:30 [INF] Processing request: /api/Campaign/17
2025-09-26 10:13:17.146 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.CancelCampaign (PromoPilot.API)'
2025-09-26 10:13:17.157 +05:30 [INF] Route matched with {action = "CancelCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CancelCampaign(Int32) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:13:17.170 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:13:17.238 +05:30 [INF] Executed DbCommand (49ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Campaign]
OUTPUT 1
WHERE [CampaignID] = @p0;
2025-09-26 10:13:17.250 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-26 10:13:17.253 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.CancelCampaign (PromoPilot.API) in 92.7943ms
2025-09-26 10:13:17.260 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.CancelCampaign (PromoPilot.API)'
2025-09-26 10:13:17.263 +05:30 [INF] Request processed successfully.
2025-09-26 10:13:17.268 +05:30 [INF] HTTP DELETE /api/Campaign/17 responded 204 in 125.6151 ms
2025-09-26 10:13:17.275 +05:30 [INF] Request finished HTTP/1.1 DELETE http://localhost:5145/api/Campaign/17 - 204 null null 147.007ms
2025-09-26 10:13:33.921 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Campaign - null null
2025-09-26 10:13:33.938 +05:30 [INF] Processing request: /api/Campaign
2025-09-26 10:13:33.942 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 10:13:33.950 +05:30 [INF] Route matched with {action = "GetAllCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCampaigns() on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:13:33.982 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
2025-09-26 10:13:34.007 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PromoPilot.Application.DTOs.CampaignDto, PromoPilot.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-26 10:13:34.011 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API) in 57.1243ms
2025-09-26 10:13:34.015 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 10:13:34.017 +05:30 [INF] Request processed successfully.
2025-09-26 10:13:34.018 +05:30 [INF] HTTP GET /api/Campaign responded 200 in 80.1927 ms
2025-09-26 10:13:34.021 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Campaign - 200 null application/json; charset=utf-8 99.5427ms
2025-09-26 10:15:51.091 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/18 - application/json 196
2025-09-26 10:15:51.105 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:15:51.107 +05:30 [INF] Processing request: /api/Campaign/18
2025-09-26 10:15:51.111 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:15:51.116 +05:30 [INF] Route matched with {action = "UpdateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCampaign(Int32, PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:15:51.143 +05:30 [INF] Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:15:51.157 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:15:51.163 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API) in 38.2115ms
2025-09-26 10:15:51.167 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:15:51.170 +05:30 [INF] Request processed successfully.
2025-09-26 10:15:51.172 +05:30 [INF] HTTP PUT /api/Campaign/18 responded 200 in 66.8948 ms
2025-09-26 10:15:51.176 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/18 - 200 null application/json; charset=utf-8 84.483ms
2025-09-26 10:16:09.743 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Campaign - null null
2025-09-26 10:16:09.757 +05:30 [INF] Processing request: /api/Campaign
2025-09-26 10:16:09.759 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 10:16:09.761 +05:30 [INF] Route matched with {action = "GetAllCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCampaigns() on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:16:09.775 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
2025-09-26 10:16:09.785 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PromoPilot.Application.DTOs.CampaignDto, PromoPilot.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-26 10:16:09.792 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API) in 26.0617ms
2025-09-26 10:16:09.794 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 10:16:09.797 +05:30 [INF] Request processed successfully.
2025-09-26 10:16:09.800 +05:30 [INF] HTTP GET /api/Campaign responded 200 in 42.5949 ms
2025-09-26 10:16:09.807 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Campaign - 200 null application/json; charset=utf-8 64.5686ms
2025-09-26 10:16:33.793 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/19 - application/json 176
2025-09-26 10:16:33.819 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:16:33.822 +05:30 [INF] Processing request: /api/Campaign/19
2025-09-26 10:16:33.826 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:16:33.830 +05:30 [INF] Route matched with {action = "UpdateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCampaign(Int32, PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:16:33.845 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:16:33.860 +05:30 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-26 10:16:33.915 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API) in 77.0552ms
2025-09-26 10:16:33.921 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:16:33.924 +05:30 [INF] Request processed successfully.
2025-09-26 10:16:33.928 +05:30 [INF] HTTP PUT /api/Campaign/19 responded 404 in 108.9676 ms
2025-09-26 10:16:33.933 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/19 - 404 null application/problem+json; charset=utf-8 139.3541ms
2025-09-26 10:16:46.024 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/17 - application/json 176
2025-09-26 10:16:46.031 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:16:46.032 +05:30 [INF] Processing request: /api/Campaign/17
2025-09-26 10:16:46.035 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:16:46.037 +05:30 [INF] Route matched with {action = "UpdateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCampaign(Int32, PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:16:46.045 +05:30 [INF] Executed DbCommand (1ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:16:46.052 +05:30 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-26 10:16:46.055 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API) in 15.0739ms
2025-09-26 10:16:46.058 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:16:46.059 +05:30 [INF] Request processed successfully.
2025-09-26 10:16:46.060 +05:30 [INF] HTTP PUT /api/Campaign/17 responded 404 in 30.0309 ms
2025-09-26 10:16:46.063 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/17 - 404 null application/problem+json; charset=utf-8 39.7235ms
2025-09-26 10:16:52.814 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/16 - application/json 176
2025-09-26 10:16:52.828 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:16:52.831 +05:30 [INF] Processing request: /api/Campaign/16
2025-09-26 10:16:52.834 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:16:52.838 +05:30 [INF] Route matched with {action = "UpdateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCampaign(Int32, PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:16:52.847 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:16:52.865 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Campaign] SET [EndDate] = @p0, [Name] = @p1, [StartDate] = @p2, [StoreList] = @p3, [TargetProducts] = @p4
OUTPUT 1
WHERE [CampaignID] = @p5;
2025-09-26 10:16:52.871 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:16:52.874 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API) in 32.9154ms
2025-09-26 10:16:52.877 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:16:52.880 +05:30 [INF] Request processed successfully.
2025-09-26 10:16:52.881 +05:30 [INF] HTTP PUT /api/Campaign/16 responded 200 in 52.9548 ms
2025-09-26 10:16:52.887 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/16 - 200 null application/json; charset=utf-8 73.034ms
2025-09-26 10:17:03.340 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Campaign - null null
2025-09-26 10:17:03.344 +05:30 [INF] Processing request: /api/Campaign
2025-09-26 10:17:03.346 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 10:17:03.348 +05:30 [INF] Route matched with {action = "GetAllCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCampaigns() on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:17:03.359 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
2025-09-26 10:17:03.372 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PromoPilot.Application.DTOs.CampaignDto, PromoPilot.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-26 10:17:03.375 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API) in 23.7485ms
2025-09-26 10:17:03.379 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 10:17:03.383 +05:30 [INF] Request processed successfully.
2025-09-26 10:17:03.387 +05:30 [INF] HTTP GET /api/Campaign responded 200 in 42.3683 ms
2025-09-26 10:17:03.390 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Campaign - 200 null application/json; charset=utf-8 50.0544ms
2025-09-26 10:29:12.420 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 171
2025-09-26 10:29:12.472 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:29:12.482 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 10:29:12.491 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:29:12.501 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:29:12.534 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-26 10:29:12.562 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 41.195ms
2025-09-26 10:29:12.573 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:29:12.578 +05:30 [INF] Request processed successfully.
2025-09-26 10:29:12.583 +05:30 [INF] HTTP POST /api/Campaign/plan responded 400 in 111.1784 ms
2025-09-26 10:29:12.596 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 400 null application/problem+json; charset=utf-8 176.0877ms
2025-09-26 10:40:25.451 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 10:40:25.957 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 10:40:25.961 +05:30 [INF] Hosting environment: Development
2025-09-26 10:40:25.963 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 10:40:27.584 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 10:40:28.189 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 229.6784 ms
2025-09-26 10:40:28.217 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 10:40:28.218 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 633.0281ms
2025-09-26 10:40:28.224 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 10:40:28.245 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 31.7323ms
2025-09-26 10:40:28.347 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 123.7924ms
2025-09-26 10:40:28.395 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 10:40:28.457 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 52.6050 ms
2025-09-26 10:40:28.469 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 73.9579ms
2025-09-26 10:41:54.133 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 198
2025-09-26 10:41:54.185 +05:30 [WRN] Failed to determine the https port for redirect.
2025-09-26 10:41:54.197 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:41:54.354 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 10:41:54.381 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:41:54.518 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:42:07.150 +05:30 [INF] Executed DbCommand (482ms) [Parameters=[@__name_0='?' (Size = 4000), @__start_1='?' (DbType = DateTime2), @__end_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[Name] = @__name_0 AND [c].[StartDate] = @__start_1 AND [c].[EndDate] = @__end_2
2025-09-26 10:42:07.840 +05:30 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Campaign] ([EndDate], [Name], [StartDate], [StoreList], [TargetProducts])
OUTPUT INSERTED.[CampaignID]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 10:42:07.971 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:42:08.045 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 13506.2886ms
2025-09-26 10:42:08.054 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:42:08.067 +05:30 [INF] Request processed successfully.
2025-09-26 10:42:08.076 +05:30 [INF] HTTP POST /api/Campaign/plan responded 201 in 13914.1469 ms
2025-09-26 10:42:08.114 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 201 null application/json; charset=utf-8 13980.9067ms
2025-09-26 10:43:40.432 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 198
2025-09-26 10:43:40.455 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:43:40.492 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 10:43:40.508 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:43:40.514 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:43:40.647 +05:30 [INF] Executed DbCommand (25ms) [Parameters=[@__name_0='?' (Size = 4000), @__start_1='?' (DbType = DateTime2), @__end_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[Name] = @__name_0 AND [c].[StartDate] = @__start_1 AND [c].[EndDate] = @__end_2
2025-09-26 10:43:41.139 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 613.3143ms
2025-09-26 10:43:41.157 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 10:43:41.417 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Campaign/plan
System.InvalidOperationException: Campaign already exists with same name and dates.
   at CampaignService.AddAsync(CampaignDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\CampaignService.cs:line 34
   at PromoPilot.Application.UseCases.Campaigns.PlanCampaignUseCase.ExecuteAsync(CampaignDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Campaigns\PlanCampaignUseCase.cs:line 18
   at PromoPilot.API.Controllers.CampaignController.PlanCampaign(CampaignDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\CampaignController.cs:line 25
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 10:43:41.610 +05:30 [ERR] HTTP POST /api/Campaign/plan responded 500 in 1156.5996 ms
2025-09-26 10:43:41.624 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 500 null application/json 1192.742ms
2025-09-26 10:44:34.534 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/19 - application/json 231
2025-09-26 10:44:34.571 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:44:34.582 +05:30 [INF] Processing request: /api/Campaign/19
2025-09-26 10:44:34.597 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:44:34.631 +05:30 [INF] Route matched with {action = "UpdateCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] UpdateCampaign(Int32, PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:44:35.085 +05:30 [INF] Executed DbCommand (14ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:44:35.170 +05:30 [INF] Executed DbCommand (29ms) [Parameters=[@p3='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Campaign] SET [Name] = @p0, [StoreList] = @p1, [TargetProducts] = @p2
OUTPUT 1
WHERE [CampaignID] = @p3;
2025-09-26 10:44:35.193 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:44:35.204 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API) in 556.8249ms
2025-09-26 10:44:35.212 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.UpdateCampaign (PromoPilot.API)'
2025-09-26 10:44:35.224 +05:30 [INF] Request processed successfully.
2025-09-26 10:44:35.230 +05:30 [INF] HTTP PUT /api/Campaign/19 responded 200 in 660.5975 ms
2025-09-26 10:44:35.248 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/19 - 200 null application/json; charset=utf-8 713.5865ms
2025-09-26 10:45:16.684 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Campaign - null null
2025-09-26 10:45:16.708 +05:30 [INF] Processing request: /api/Campaign
2025-09-26 10:45:16.711 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 10:45:16.724 +05:30 [INF] Route matched with {action = "GetAllCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCampaigns() on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:45:16.782 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
2025-09-26 10:45:16.885 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PromoPilot.Application.DTOs.CampaignDto, PromoPilot.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-26 10:45:16.896 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API) in 162.7808ms
2025-09-26 10:45:16.908 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 10:45:16.916 +05:30 [INF] Request processed successfully.
2025-09-26 10:45:16.920 +05:30 [INF] HTTP GET /api/Campaign responded 200 in 213.0424 ms
2025-09-26 10:45:16.928 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Campaign - 200 null application/json; charset=utf-8 244.4209ms
2025-09-26 10:45:47.713 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Campaign/19 - null null
2025-09-26 10:45:47.755 +05:30 [INF] Processing request: /api/Campaign/19
2025-09-26 10:45:47.766 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.GetCampaignById (PromoPilot.API)'
2025-09-26 10:45:47.792 +05:30 [INF] Route matched with {action = "GetCampaignById", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetCampaignById(Int32) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:45:47.889 +05:30 [INF] Executed DbCommand (55ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:45:47.902 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:45:47.909 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.GetCampaignById (PromoPilot.API) in 98.4212ms
2025-09-26 10:45:47.922 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.GetCampaignById (PromoPilot.API)'
2025-09-26 10:45:47.926 +05:30 [INF] Request processed successfully.
2025-09-26 10:45:47.931 +05:30 [INF] HTTP GET /api/Campaign/19 responded 200 in 177.3721 ms
2025-09-26 10:45:47.944 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Campaign/19 - 200 null application/json; charset=utf-8 230.8579ms
2025-09-26 10:46:44.024 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Campaign - null null
2025-09-26 10:46:44.053 +05:30 [INF] Processing request: /api/Campaign
2025-09-26 10:46:44.058 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 10:46:44.062 +05:30 [INF] Route matched with {action = "GetAllCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCampaigns() on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:46:44.100 +05:30 [INF] Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
2025-09-26 10:46:44.116 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PromoPilot.Application.DTOs.CampaignDto, PromoPilot.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-26 10:46:44.131 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API) in 55.1529ms
2025-09-26 10:46:44.159 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 10:46:44.165 +05:30 [INF] Request processed successfully.
2025-09-26 10:46:44.173 +05:30 [INF] HTTP GET /api/Campaign responded 200 in 120.6901 ms
2025-09-26 10:46:44.187 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Campaign - 200 null application/json; charset=utf-8 163.1489ms
2025-09-26 10:47:06.927 +05:30 [INF] Request starting HTTP/1.1 DELETE http://localhost:5145/api/Campaign/16 - null null
2025-09-26 10:47:06.955 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:47:06.961 +05:30 [INF] Processing request: /api/Campaign/16
2025-09-26 10:47:06.972 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.CancelCampaign (PromoPilot.API)'
2025-09-26 10:47:06.992 +05:30 [INF] Route matched with {action = "CancelCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] CancelCampaign(Int32) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:47:07.023 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:47:07.152 +05:30 [INF] Executed DbCommand (77ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [Campaign]
OUTPUT 1
WHERE [CampaignID] = @p0;
2025-09-26 10:47:07.191 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-26 10:47:07.199 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.CancelCampaign (PromoPilot.API) in 193.39ms
2025-09-26 10:47:07.210 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.CancelCampaign (PromoPilot.API)'
2025-09-26 10:47:07.220 +05:30 [INF] Request processed successfully.
2025-09-26 10:47:07.226 +05:30 [INF] HTTP DELETE /api/Campaign/16 responded 204 in 271.0809 ms
2025-09-26 10:47:07.242 +05:30 [INF] Request finished HTTP/1.1 DELETE http://localhost:5145/api/Campaign/16 - 204 null null 314.6914ms
2025-09-26 10:49:10.605 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Campaign/schedule/18 - application/json 11
2025-09-26 10:49:10.646 +05:30 [INF] CORS policy execution successful.
2025-09-26 10:49:10.658 +05:30 [INF] Processing request: /api/Campaign/schedule/18
2025-09-26 10:49:10.665 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API)'
2025-09-26 10:49:10.693 +05:30 [INF] Route matched with {action = "ScheduleCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] ScheduleCampaign(Int32, System.String) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 10:49:10.732 +05:30 [INF] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[CampaignID] = @__p_0
2025-09-26 10:49:10.765 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 10:49:10.774 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API) in 68.6513ms
2025-09-26 10:49:10.781 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.ScheduleCampaign (PromoPilot.API)'
2025-09-26 10:49:10.791 +05:30 [INF] Request processed successfully.
2025-09-26 10:49:10.794 +05:30 [INF] HTTP PUT /api/Campaign/schedule/18 responded 200 in 148.0780 ms
2025-09-26 10:49:10.807 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Campaign/schedule/18 - 200 null application/json; charset=utf-8 201.6399ms
2025-09-26 10:50:23.411 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 10:50:24.015 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 10:50:24.018 +05:30 [INF] Hosting environment: Development
2025-09-26 10:50:24.020 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 10:50:25.904 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 10:50:26.818 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 291.5658 ms
2025-09-26 10:50:26.861 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 10:50:26.861 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 10:50:26.890 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 1003.0866ms
2025-09-26 10:50:26.911 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 49.8383ms
2025-09-26 10:50:27.059 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 198.0931ms
2025-09-26 10:50:27.121 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 10:50:27.193 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 60.0114 ms
2025-09-26 10:50:27.204 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 83.147ms
2025-09-26 10:53:58.338 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 10:53:58.876 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 10:53:58.882 +05:30 [INF] Hosting environment: Development
2025-09-26 10:53:58.888 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 10:54:00.332 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 10:54:00.847 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 201.4343 ms
2025-09-26 10:54:00.877 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 10:54:00.877 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 10:54:00.904 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 565.8643ms
2025-09-26 10:54:00.908 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 31.7717ms
2025-09-26 10:54:00.991 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 114.1281ms
2025-09-26 10:54:01.155 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 10:54:01.212 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 47.8391 ms
2025-09-26 10:54:01.218 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 63.5748ms
2025-09-26 11:19:28.160 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 11:19:28.679 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 11:19:28.681 +05:30 [INF] Hosting environment: Development
2025-09-26 11:19:28.682 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 11:19:30.529 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 11:19:31.451 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 249.6784 ms
2025-09-26 11:19:31.482 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 963.6618ms
2025-09-26 11:19:31.486 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 11:19:31.486 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 11:19:31.508 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 23.9835ms
2025-09-26 11:19:31.608 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 123.9722ms
2025-09-26 11:19:31.656 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 11:19:31.721 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 54.5790 ms
2025-09-26 11:19:31.728 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 71.6281ms
2025-09-26 11:20:36.155 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 178
2025-09-26 11:20:36.193 +05:30 [WRN] Failed to determine the https port for redirect.
2025-09-26 11:20:36.204 +05:30 [INF] CORS policy execution successful.
2025-09-26 11:20:36.335 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 11:20:36.354 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 11:20:36.495 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 11:20:39.675 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-26 11:20:39.799 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 3277.6308ms
2025-09-26 11:20:39.810 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 11:20:39.819 +05:30 [INF] Request processed successfully.
2025-09-26 11:20:39.824 +05:30 [INF] HTTP POST /api/Campaign/plan responded 400 in 3649.4459 ms
2025-09-26 11:20:39.839 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 400 null application/problem+json; charset=utf-8 3683.8528ms
2025-09-26 11:20:50.882 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 178
2025-09-26 11:20:50.902 +05:30 [INF] CORS policy execution successful.
2025-09-26 11:20:50.921 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 11:20:50.931 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 11:20:50.943 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 11:21:00.208 +05:30 [INF] Executed DbCommand (489ms) [Parameters=[@__name_0='?' (Size = 4000), @__start_1='?' (DbType = DateTime2), @__end_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[Name] = @__name_0 AND [c].[StartDate] = @__start_1 AND [c].[EndDate] = @__end_2
2025-09-26 11:21:01.080 +05:30 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Campaign] ([EndDate], [Name], [StartDate], [StoreList], [TargetProducts])
OUTPUT INSERTED.[CampaignID]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 11:21:01.215 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 11:21:01.315 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 10356.0421ms
2025-09-26 11:21:01.322 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 11:21:01.329 +05:30 [INF] Request processed successfully.
2025-09-26 11:21:01.336 +05:30 [INF] HTTP POST /api/Campaign/plan responded 201 in 10435.1704 ms
2025-09-26 11:21:01.361 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 201 null application/json; charset=utf-8 10479.1319ms
2025-09-26 11:21:27.342 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 146
2025-09-26 11:21:27.367 +05:30 [INF] CORS policy execution successful.
2025-09-26 11:21:27.372 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 11:21:27.376 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 11:21:27.382 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 11:21:27.418 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-26 11:21:27.426 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 34.7692ms
2025-09-26 11:21:27.432 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 11:21:27.438 +05:30 [INF] Request processed successfully.
2025-09-26 11:21:27.442 +05:30 [INF] HTTP POST /api/Campaign/plan responded 400 in 76.2622 ms
2025-09-26 11:21:27.455 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 400 null application/problem+json; charset=utf-8 112.9265ms
2025-09-26 11:24:36.471 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 159
2025-09-26 11:24:36.502 +05:30 [INF] CORS policy execution successful.
2025-09-26 11:24:36.508 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 11:24:36.513 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 11:24:36.521 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 11:24:36.645 +05:30 [INF] Executed DbCommand (12ms) [Parameters=[@__name_0='?' (Size = 4000), @__start_1='?' (DbType = DateTime2), @__end_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[Name] = @__name_0 AND [c].[StartDate] = @__start_1 AND [c].[EndDate] = @__end_2
2025-09-26 11:24:37.132 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 598.0469ms
2025-09-26 11:24:37.147 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 11:24:37.433 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Campaign/plan
System.InvalidOperationException: Campaign already exists with same name and dates.
   at CampaignService.AddAsync(CampaignDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\CampaignService.cs:line 34
   at PromoPilot.Application.UseCases.Campaigns.PlanCampaignUseCase.ExecuteAsync(CampaignDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Campaigns\PlanCampaignUseCase.cs:line 18
   at PromoPilot.API.Controllers.CampaignController.PlanCampaign(CampaignDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\CampaignController.cs:line 25
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 11:24:37.659 +05:30 [ERR] HTTP POST /api/Campaign/plan responded 500 in 1156.8354 ms
2025-09-26 11:24:37.671 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 500 null application/json 1199.1917ms
2025-09-26 13:04:58.916 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 13:04:59.304 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 13:04:59.307 +05:30 [INF] Hosting environment: Development
2025-09-26 13:04:59.310 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 13:05:01.137 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 13:05:01.562 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 121.0943 ms
2025-09-26 13:05:01.578 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 13:05:01.579 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 445.9273ms
2025-09-26 13:05:01.596 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 13:05:01.621 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 45.8395ms
2025-09-26 13:05:01.706 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 110.2203ms
2025-09-26 13:05:01.771 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 13:05:01.814 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 36.6374 ms
2025-09-26 13:05:01.820 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 49.4268ms
2025-09-26 13:08:01.157 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 92
2025-09-26 13:08:01.184 +05:30 [WRN] Failed to determine the https port for redirect.
2025-09-26 13:08:01.190 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:08:01.287 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:08:01.296 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:08:01.366 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:08:03.246 +05:30 [INF] Allocating budget for CampaignID: 1, StoreID: 101
2025-09-26 13:08:07.973 +05:30 [INF] Executed DbCommand (230ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:08:08.083 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:08:08.579 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 7200.8519ms
2025-09-26 13:08:08.585 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:08:08.771 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:08:08.918 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 7741.9148 ms
2025-09-26 13:08:08.936 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 7779.0286ms
2025-09-26 13:08:28.391 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 73
2025-09-26 13:08:28.399 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:08:28.403 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:08:28.405 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:08:28.408 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:08:28.417 +05:30 [INF] Allocating budget for CampaignID: 0, StoreID: 101
2025-09-26 13:08:28.550 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:08:28.561 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:08:28.949 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 537.2703ms
2025-09-26 13:08:28.954 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:08:29.082 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:08:29.120 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 722.2480 ms
2025-09-26 13:08:29.127 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 735.6924ms
2025-09-26 13:08:37.373 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 73
2025-09-26 13:08:37.380 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:08:37.382 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:08:37.383 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:08:37.385 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:08:37.400 +05:30 [INF] Allocating budget for CampaignID: 0, StoreID: 101
2025-09-26 13:08:37.426 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:08:37.436 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:08:37.828 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 438.5521ms
2025-09-26 13:08:37.831 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:08:37.956 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:08:37.981 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 601.7711 ms
2025-09-26 13:08:37.985 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 611.36ms
2025-09-26 13:09:55.436 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 92
2025-09-26 13:09:55.454 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:09:55.457 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:09:55.461 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:09:55.465 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:09:55.473 +05:30 [INF] Allocating budget for CampaignID: 2, StoreID: 101
2025-09-26 13:09:55.496 +05:30 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:09:55.560 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'PromoPilot.Application.DTOs.BudgetDto'.
2025-09-26 13:09:55.608 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 135.1187ms
2025-09-26 13:09:55.612 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:09:55.615 +05:30 [INF] Request processed successfully.
2025-09-26 13:09:55.617 +05:30 [INF] HTTP POST /api/Budget responded 201 in 162.5505 ms
2025-09-26 13:09:55.621 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 201 null application/json; charset=utf-8 184.9265ms
2025-09-26 13:12:12.780 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 92
2025-09-26 13:12:12.800 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:12:12.802 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:12:12.803 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:12:12.807 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:12:12.818 +05:30 [INF] Allocating budget for CampaignID: 2, StoreID: 102
2025-09-26 13:12:12.838 +05:30 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:12:12.850 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'PromoPilot.Application.DTOs.BudgetDto'.
2025-09-26 13:12:12.855 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 38.5547ms
2025-09-26 13:12:12.860 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:12:12.861 +05:30 [INF] Request processed successfully.
2025-09-26 13:12:12.863 +05:30 [INF] HTTP POST /api/Budget responded 201 in 62.4281 ms
2025-09-26 13:12:12.865 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 201 null application/json; charset=utf-8 85.2966ms
2025-09-26 13:12:48.792 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 73
2025-09-26 13:12:48.811 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:12:48.814 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:12:48.818 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:12:48.821 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:12:48.827 +05:30 [INF] Allocating budget for CampaignID: 0, StoreID: 102
2025-09-26 13:12:48.840 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:12:48.851 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:12:49.299 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 473.3593ms
2025-09-26 13:12:49.306 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:12:49.439 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:12:49.470 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 659.2143 ms
2025-09-26 13:12:49.475 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 683.1174ms
2025-09-26 13:13:41.816 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 91
2025-09-26 13:13:41.830 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:13:41.831 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:13:41.835 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:13:41.839 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:13:41.847 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-26 13:13:41.897 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 54.5149ms
2025-09-26 13:13:41.902 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:13:41.904 +05:30 [INF] Request processed successfully.
2025-09-26 13:13:41.906 +05:30 [INF] HTTP POST /api/Budget responded 400 in 76.8481 ms
2025-09-26 13:13:41.913 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 400 null application/problem+json; charset=utf-8 96.7694ms
2025-09-26 13:14:05.961 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 109
2025-09-26 13:14:05.994 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:14:06.000 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:14:06.006 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:14:06.013 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:14:06.031 +05:30 [INF] Allocating budget for CampaignID: 1, StoreID: 101
2025-09-26 13:14:06.094 +05:30 [ERR] Failed executing DbCommand (47ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([BudgetID], [AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 13:14:06.128 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:14:06.895 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 867.3845ms
2025-09-26 13:14:06.909 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:14:07.249 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:14:07.334 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 1340.0433 ms
2025-09-26 13:14:07.350 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 1389.4789ms
2025-09-26 13:14:19.244 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 109
2025-09-26 13:14:19.262 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:14:19.264 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:14:19.267 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:14:19.270 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:14:19.277 +05:30 [INF] Allocating budget for CampaignID: 2, StoreID: 101
2025-09-26 13:14:19.311 +05:30 [ERR] Failed executing DbCommand (26ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([BudgetID], [AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 13:14:19.327 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:14:19.802 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 526.9835ms
2025-09-26 13:14:19.807 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:14:20.078 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:14:20.181 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 918.6400 ms
2025-09-26 13:14:20.194 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 950.2838ms
2025-09-26 13:14:30.573 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 109
2025-09-26 13:14:30.585 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:14:30.588 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:14:30.592 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:14:30.599 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:14:30.608 +05:30 [INF] Allocating budget for CampaignID: 2, StoreID: 101
2025-09-26 13:14:30.630 +05:30 [ERR] Failed executing DbCommand (14ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([BudgetID], [AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 13:14:30.650 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:14:31.235 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 628.5966ms
2025-09-26 13:14:31.244 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:14:31.545 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:14:31.648 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 1063.4726 ms
2025-09-26 13:14:31.658 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 1085.7983ms
2025-09-26 13:15:18.760 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 109
2025-09-26 13:15:18.829 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:15:18.835 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:15:18.853 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:15:18.875 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:15:18.919 +05:30 [INF] Allocating budget for CampaignID: 2, StoreID: 101
2025-09-26 13:15:18.991 +05:30 [ERR] Failed executing DbCommand (46ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([BudgetID], [AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 13:15:19.014 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:15:19.783 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 867.1402ms
2025-09-26 13:15:19.793 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:15:20.100 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:15:20.242 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 1413.2216 ms
2025-09-26 13:15:20.255 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 1495.3624ms
2025-09-26 13:15:23.122 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 109
2025-09-26 13:15:23.134 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:15:23.138 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:15:23.143 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:15:23.150 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:15:23.161 +05:30 [INF] Allocating budget for CampaignID: 2, StoreID: 101
2025-09-26 13:15:23.186 +05:30 [ERR] Failed executing DbCommand (15ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([BudgetID], [AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 13:15:23.208 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:15:23.924 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 764.0501ms
2025-09-26 13:15:23.940 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:15:24.203 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:15:24.316 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 1182.0664 ms
2025-09-26 13:15:24.330 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 1207.4183ms
2025-09-26 13:16:10.685 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 109
2025-09-26 13:16:10.696 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:16:10.698 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:16:10.700 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:16:10.702 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:16:10.706 +05:30 [INF] Allocating budget for CampaignID: 2, StoreID: 101
2025-09-26 13:16:10.723 +05:30 [ERR] Failed executing DbCommand (9ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([BudgetID], [AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 13:16:10.735 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:16:11.049 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 343.5283ms
2025-09-26 13:16:11.052 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:16:11.185 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:16:11.217 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 521.0054 ms
2025-09-26 13:16:11.223 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 537.7095ms
2025-09-26 13:16:20.026 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 110
2025-09-26 13:16:20.045 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:16:20.049 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:16:20.053 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:16:20.056 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:16:20.062 +05:30 [INF] Allocating budget for CampaignID: 2, StoreID: 101
2025-09-26 13:16:20.078 +05:30 [ERR] Failed executing DbCommand (10ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([BudgetID], [AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 13:16:20.097 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:16:20.423 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 362.1603ms
2025-09-26 13:16:20.426 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:16:20.506 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:16:20.528 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 483.1597 ms
2025-09-26 13:16:20.531 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 506.6947ms
2025-09-26 13:16:31.958 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 110
2025-09-26 13:16:31.963 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:16:31.965 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:16:31.967 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:16:31.969 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:16:31.973 +05:30 [INF] Allocating budget for CampaignID: 3, StoreID: 101
2025-09-26 13:16:31.983 +05:30 [ERR] Failed executing DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p2='?' (DbType = Int32), @p3='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p4='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([BudgetID], [AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 13:16:31.990 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:16:32.219 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 246.6959ms
2025-09-26 13:16:32.223 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:16:32.292 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert explicit value for identity column in table 'Budget' when IDENTITY_INSERT is set to OFF.
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__211_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location ---
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:544,State:1,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:16:32.323 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 360.2800 ms
2025-09-26 13:16:32.326 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 368.5321ms
2025-09-26 13:17:23.692 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Budget/1 - application/json 109
2025-09-26 13:17:23.713 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:17:23.717 +05:30 [INF] Processing request: /api/Budget/1
2025-09-26 13:17:23.722 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API)'
2025-09-26 13:17:23.738 +05:30 [INF] Route matched with {action = "Update", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:17:23.751 +05:30 [INF] Retrieving budget allocation for ID: 1
2025-09-26 13:17:24.179 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BudgetID], [b].[AllocatedAmount], [b].[CampaignID], [b].[SpentAmount], [b].[StoreID]
FROM [Budget] AS [b]
WHERE [b].[BudgetID] = @__p_0
2025-09-26 13:17:24.193 +05:30 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-26 13:17:24.201 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API) in 457.503ms
2025-09-26 13:17:24.205 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API)'
2025-09-26 13:17:24.207 +05:30 [INF] Request processed successfully.
2025-09-26 13:17:24.208 +05:30 [INF] HTTP PUT /api/Budget/1 responded 404 in 495.5624 ms
2025-09-26 13:17:24.212 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Budget/1 - 404 null application/problem+json; charset=utf-8 519.9256ms
2025-09-26 13:17:32.180 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Budget/1 - application/json 109
2025-09-26 13:17:32.197 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:17:32.202 +05:30 [INF] Processing request: /api/Budget/1
2025-09-26 13:17:32.208 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API)'
2025-09-26 13:17:32.212 +05:30 [INF] Route matched with {action = "Update", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:17:32.224 +05:30 [INF] Retrieving budget allocation for ID: 1
2025-09-26 13:17:32.245 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BudgetID], [b].[AllocatedAmount], [b].[CampaignID], [b].[SpentAmount], [b].[StoreID]
FROM [Budget] AS [b]
WHERE [b].[BudgetID] = @__p_0
2025-09-26 13:17:32.273 +05:30 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-26 13:17:32.280 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API) in 58.2908ms
2025-09-26 13:17:32.292 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API)'
2025-09-26 13:17:32.299 +05:30 [INF] Request processed successfully.
2025-09-26 13:17:32.306 +05:30 [INF] HTTP PUT /api/Budget/1 responded 404 in 108.2061 ms
2025-09-26 13:17:32.317 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Budget/1 - 404 null application/problem+json; charset=utf-8 137.157ms
2025-09-26 13:17:39.072 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Budget/1 - application/json 110
2025-09-26 13:17:39.085 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:17:39.087 +05:30 [INF] Processing request: /api/Budget/1
2025-09-26 13:17:39.089 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API)'
2025-09-26 13:17:39.091 +05:30 [INF] Route matched with {action = "Update", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:17:39.094 +05:30 [INF] Retrieving budget allocation for ID: 1
2025-09-26 13:17:39.100 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BudgetID], [b].[AllocatedAmount], [b].[CampaignID], [b].[SpentAmount], [b].[StoreID]
FROM [Budget] AS [b]
WHERE [b].[BudgetID] = @__p_0
2025-09-26 13:17:39.104 +05:30 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-26 13:17:39.107 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API) in 13.6455ms
2025-09-26 13:17:39.109 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API)'
2025-09-26 13:17:39.111 +05:30 [INF] Request processed successfully.
2025-09-26 13:17:39.112 +05:30 [INF] HTTP PUT /api/Budget/1 responded 404 in 28.1847 ms
2025-09-26 13:17:39.116 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Budget/1 - 404 null application/problem+json; charset=utf-8 43.6158ms
2025-09-26 13:17:46.289 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Budget/1 - application/json 110
2025-09-26 13:17:46.296 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:17:46.299 +05:30 [INF] Processing request: /api/Budget/1
2025-09-26 13:17:46.301 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API)'
2025-09-26 13:17:46.305 +05:30 [INF] Route matched with {action = "Update", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:17:46.312 +05:30 [INF] Retrieving budget allocation for ID: 1
2025-09-26 13:17:46.320 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BudgetID], [b].[AllocatedAmount], [b].[CampaignID], [b].[SpentAmount], [b].[StoreID]
FROM [Budget] AS [b]
WHERE [b].[BudgetID] = @__p_0
2025-09-26 13:17:46.333 +05:30 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-26 13:17:46.335 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API) in 23.344ms
2025-09-26 13:17:46.337 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API)'
2025-09-26 13:17:46.339 +05:30 [INF] Request processed successfully.
2025-09-26 13:17:46.341 +05:30 [INF] HTTP PUT /api/Budget/1 responded 404 in 44.9518 ms
2025-09-26 13:17:46.345 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Budget/1 - 404 null application/problem+json; charset=utf-8 55.7439ms
2025-09-26 13:17:58.691 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Budget - null null
2025-09-26 13:17:58.699 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:17:58.701 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.GetAll (PromoPilot.API)'
2025-09-26 13:17:58.709 +05:30 [INF] Route matched with {action = "GetAll", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:17:58.715 +05:30 [INF] Retrieving all budget allocations.
2025-09-26 13:17:58.748 +05:30 [INF] Executed DbCommand (12ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [b].[BudgetID], [b].[AllocatedAmount], [b].[CampaignID], [b].[SpentAmount], [b].[StoreID]
FROM [Budget] AS [b]
2025-09-26 13:17:58.777 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PromoPilot.Application.DTOs.BudgetDto, PromoPilot.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-26 13:17:58.785 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.GetAll (PromoPilot.API) in 71.8399ms
2025-09-26 13:17:58.788 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.GetAll (PromoPilot.API)'
2025-09-26 13:17:58.790 +05:30 [INF] Request processed successfully.
2025-09-26 13:17:58.792 +05:30 [INF] HTTP GET /api/Budget responded 200 in 94.0649 ms
2025-09-26 13:17:58.796 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Budget - 200 null application/json; charset=utf-8 105.6796ms
2025-09-26 13:18:30.423 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/Budget/9 - application/json 120
2025-09-26 13:18:30.438 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:18:30.439 +05:30 [INF] Processing request: /api/Budget/9
2025-09-26 13:18:30.441 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API)'
2025-09-26 13:18:30.443 +05:30 [INF] Route matched with {action = "Update", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:18:30.448 +05:30 [INF] Retrieving budget allocation for ID: 9
2025-09-26 13:18:30.459 +05:30 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [b].[BudgetID], [b].[AllocatedAmount], [b].[CampaignID], [b].[SpentAmount], [b].[StoreID]
FROM [Budget] AS [b]
WHERE [b].[BudgetID] = @__p_0
2025-09-26 13:18:30.475 +05:30 [INF] Tracking spend for BudgetID: 9
2025-09-26 13:18:30.514 +05:30 [INF] Executed DbCommand (31ms) [Parameters=[@p4='?' (DbType = Int32), @p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [Budget] SET [AllocatedAmount] = @p0, [CampaignID] = @p1, [SpentAmount] = @p2, [StoreID] = @p3
OUTPUT 1
WHERE [BudgetID] = @p4;
2025-09-26 13:18:30.520 +05:30 [INF] Executing OkObjectResult, writing value of type 'PromoPilot.Application.DTOs.BudgetDto'.
2025-09-26 13:18:30.523 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API) in 74.9287ms
2025-09-26 13:18:30.526 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Update (PromoPilot.API)'
2025-09-26 13:18:30.528 +05:30 [INF] Request processed successfully.
2025-09-26 13:18:30.530 +05:30 [INF] HTTP PUT /api/Budget/9 responded 200 in 92.6929 ms
2025-09-26 13:18:30.552 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/Budget/9 - 200 null application/json; charset=utf-8 128.9108ms
2025-09-26 13:19:10.950 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 73
2025-09-26 13:19:10.973 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:19:10.977 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:19:10.980 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:19:10.982 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:19:10.991 +05:30 [INF] Allocating budget for CampaignID: 0, StoreID: 103
2025-09-26 13:19:11.010 +05:30 [INF] Executed DbCommand (11ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:19:11.034 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:19:11.315 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 324.7149ms
2025-09-26 13:19:11.319 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:19:11.401 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:7aee12ae-459d-4d84-95c8-7f32029fea06
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 56
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:19:11.420 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 446.8609 ms
2025-09-26 13:19:11.423 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 472.726ms
2025-09-26 13:29:01.061 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 13:29:01.372 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 13:29:01.374 +05:30 [INF] Hosting environment: Development
2025-09-26 13:29:01.378 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 13:29:02.534 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 13:29:02.997 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 105.0176 ms
2025-09-26 13:29:03.010 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 13:29:03.014 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 13:29:03.025 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 487.1529ms
2025-09-26 13:29:03.029 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 20.5163ms
2025-09-26 13:29:03.077 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 62.6059ms
2025-09-26 13:29:03.127 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 13:29:03.157 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 24.4186 ms
2025-09-26 13:29:03.162 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 34.9062ms
2025-09-26 13:32:00.127 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 92
2025-09-26 13:32:00.151 +05:30 [WRN] Failed to determine the https port for redirect.
2025-09-26 13:32:00.155 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:32:00.204 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:32:00.212 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:32:00.273 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:32:02.024 +05:30 [INF] Allocating budget for CampaignID: 1, StoreID: 101
2025-09-26 13:32:05.542 +05:30 [INF] Executed DbCommand (235ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:32:05.585 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:570c844e-befb-40f0-8a04-047609de482a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:570c844e-befb-40f0-8a04-047609de482a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:32:05.870 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 5590.344ms
2025-09-26 13:32:05.874 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:32:06.007 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:570c844e-befb-40f0-8a04-047609de482a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 62
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:32:06.098 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 5953.3945 ms
2025-09-26 13:32:06.108 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 5980.9971ms
2025-09-26 13:32:11.955 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 92
2025-09-26 13:32:11.960 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:32:11.965 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:32:11.968 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:32:11.972 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:32:11.981 +05:30 [INF] Allocating budget for CampaignID: 2, StoreID: 101
2025-09-26 13:32:12.054 +05:30 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:32:12.085 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'PromoPilot.Application.DTOs.BudgetDto'.
2025-09-26 13:32:12.103 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 128.0314ms
2025-09-26 13:32:12.106 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:32:12.108 +05:30 [INF] Request processed successfully.
2025-09-26 13:32:12.110 +05:30 [INF] HTTP POST /api/Budget responded 201 in 149.8098 ms
2025-09-26 13:32:12.112 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 201 null application/json; charset=utf-8 156.4739ms
2025-09-26 13:37:12.185 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 73
2025-09-26 13:37:12.204 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:37:12.207 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:37:12.209 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:37:12.212 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:37:12.235 +05:30 [INF] Allocating budget for CampaignID: 0, StoreID: 101
2025-09-26 13:37:12.280 +05:30 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:37:12.291 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:570c844e-befb-40f0-8a04-047609de482a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:570c844e-befb-40f0-8a04-047609de482a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:37:12.668 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 449.227ms
2025-09-26 13:37:12.678 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:37:12.820 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:570c844e-befb-40f0-8a04-047609de482a
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 62
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:37:12.906 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 702.4947 ms
2025-09-26 13:37:12.911 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 727.3085ms
2025-09-26 13:45:33.867 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 13:45:34.020 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 13:45:34.022 +05:30 [INF] Hosting environment: Development
2025-09-26 13:45:34.024 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 13:45:35.298 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 13:45:35.891 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 94.2980 ms
2025-09-26 13:45:35.900 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 13:45:35.914 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 13:45:35.931 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 629.7807ms
2025-09-26 13:45:35.935 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 35.1978ms
2025-09-26 13:45:35.984 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 70.1097ms
2025-09-26 13:45:36.038 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 13:45:36.079 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 32.5095 ms
2025-09-26 13:45:36.089 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 50.8632ms
2025-09-26 13:46:01.658 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 73
2025-09-26 13:46:01.713 +05:30 [WRN] Failed to determine the https port for redirect.
2025-09-26 13:46:01.716 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:46:01.736 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:46:01.739 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:46:01.753 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:46:02.860 +05:30 [INF] Allocating budget for CampaignID: 0, StoreID: 101
2025-09-26 13:46:05.517 +05:30 [INF] Executed DbCommand (113ms) [Parameters=[@p0='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p1='?' (DbType = Int32), @p2='?' (Precision = 18) (Scale = 2) (DbType = Decimal), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Budget] ([AllocatedAmount], [CampaignID], [SpentAmount], [StoreID])
OUTPUT INSERTED.[BudgetID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 13:46:05.548 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edb1baf7-1781-482b-bdf5-9e7e76afa0f1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edb1baf7-1781-482b-bdf5-9e7e76afa0f1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 13:46:05.872 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 4112.904ms
2025-09-26 13:46:05.875 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:46:06.053 +05:30 [ERR] Unhandled exception occurred while processing request: /api/Budget
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Budget_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:edb1baf7-1781-482b-bdf5-9e7e76afa0f1
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.BudgetRepository.AddAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\BudgetRepository.cs:line 23
   at PromoPilot.Application.Services.BudgetService.AllocateBudgetAsync(Budget budget) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\BudgetService.cs:line 34
   at PromoPilot.Application.UseCases.Budgets.CreateBudgetUseCase.ExecuteAsync(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\Budgets\CreateBudgetUseCase.cs:line 22
   at PromoPilot.API.Controllers.BudgetController.Add(BudgetDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\BudgetController.cs:line 62
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 13:46:06.205 +05:30 [ERR] HTTP POST /api/Budget responded 500 in 4494.9842 ms
2025-09-26 13:46:06.211 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 500 null application/json 4553.221ms
2025-09-26 13:48:45.971 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 13:48:46.080 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 13:48:46.083 +05:30 [INF] Hosting environment: Development
2025-09-26 13:48:46.085 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 13:49:06.657 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 13:49:06.912 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 13:49:06.915 +05:30 [INF] Hosting environment: Development
2025-09-26 13:49:06.918 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 13:49:07.959 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 13:49:08.386 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 105.3675 ms
2025-09-26 13:49:08.393 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 13:49:08.393 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 13:49:08.404 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 448.0886ms
2025-09-26 13:49:08.413 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 20.6332ms
2025-09-26 13:49:08.458 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 66.1783ms
2025-09-26 13:49:08.522 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 13:49:08.560 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 29.9301 ms
2025-09-26 13:49:08.565 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 42.4074ms
2025-09-26 13:49:20.500 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Budget - application/json 73
2025-09-26 13:49:20.518 +05:30 [WRN] Failed to determine the https port for redirect.
2025-09-26 13:49:20.523 +05:30 [INF] CORS policy execution successful.
2025-09-26 13:49:20.555 +05:30 [INF] Processing request: /api/Budget
2025-09-26 13:49:20.563 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:49:20.605 +05:30 [INF] Route matched with {action = "Add", controller = "Budget"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(PromoPilot.Application.DTOs.BudgetDto) on controller PromoPilot.API.Controllers.BudgetController (PromoPilot.API).
2025-09-26 13:49:22.245 +05:30 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2025-09-26 13:49:22.274 +05:30 [INF] Executed action PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API) in 1661.2117ms
2025-09-26 13:49:22.276 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.BudgetController.Add (PromoPilot.API)'
2025-09-26 13:49:22.279 +05:30 [INF] Request processed successfully.
2025-09-26 13:49:22.280 +05:30 [INF] HTTP POST /api/Budget responded 400 in 1771.2263 ms
2025-09-26 13:49:22.283 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Budget - 400 null application/problem+json; charset=utf-8 1782.9272ms
2025-09-26 15:35:38.228 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 15:35:38.717 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 15:35:38.723 +05:30 [INF] Hosting environment: Development
2025-09-26 15:35:38.727 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 15:35:40.344 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 15:35:41.022 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 221.1674 ms
2025-09-26 15:35:41.028 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 15:35:41.028 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 15:35:41.062 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 724.8378ms
2025-09-26 15:35:41.066 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 38.1508ms
2025-09-26 15:35:41.142 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 114.2769ms
2025-09-26 15:35:41.192 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 15:35:41.266 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 62.5860 ms
2025-09-26 15:35:41.275 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 82.6589ms
2025-09-26 16:51:16.734 +05:30 [INF] Now listening on: http://localhost:5145
2025-09-26 16:51:17.091 +05:30 [INF] Application started. Press Ctrl+C to shut down.
2025-09-26 16:51:17.102 +05:30 [INF] Hosting environment: Development
2025-09-26 16:51:17.112 +05:30 [INF] Content root path: C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API
2025-09-26 16:51:18.627 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/index.html - null null
2025-09-26 16:51:19.225 +05:30 [INF] HTTP GET /swagger/index.html responded 200 in 130.6979 ms
2025-09-26 16:51:19.242 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/index.html - 200 null text/html;charset=utf-8 621.2385ms
2025-09-26 16:51:19.267 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_vs/browserLink - null null
2025-09-26 16:51:19.267 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - null null
2025-09-26 16:51:19.302 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_framework/aspnetcore-browser-refresh.js - 200 16513 application/javascript; charset=utf-8 48.349ms
2025-09-26 16:51:19.360 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/_vs/browserLink - 200 null text/javascript; charset=UTF-8 106.4202ms
2025-09-26 16:51:19.423 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - null null
2025-09-26 16:51:19.465 +05:30 [INF] HTTP GET /swagger/v1/swagger.json responded 200 in 34.4344 ms
2025-09-26 16:51:19.470 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/swagger/v1/swagger.json - 200 null application/json;charset=utf-8 46.911ms
2025-09-26 16:52:59.118 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/ExecutionStatus - null null
2025-09-26 16:52:59.132 +05:30 [WRN] Failed to determine the https port for redirect.
2025-09-26 16:52:59.193 +05:30 [INF] Processing request: /api/ExecutionStatus
2025-09-26 16:52:59.206 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.GetAll (PromoPilot.API)'
2025-09-26 16:52:59.278 +05:30 [INF] Route matched with {action = "GetAll", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAll() on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:53:01.018 +05:30 [INF] Fetching all execution statuses.
2025-09-26 16:53:01.023 +05:30 [INF] Fetching all execution statuses.
2025-09-26 16:53:04.591 +05:30 [INF] Executed DbCommand (106ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [e].[StatusID], [e].[CampaignID], [e].[Feedback], [e].[Status], [e].[StoreID]
FROM [ExecutionStatus] AS [e]
2025-09-26 16:53:04.751 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[ExecutionStatusDto, PromoPilot.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-26 16:53:04.774 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.GetAll (PromoPilot.API) in 5483.4098ms
2025-09-26 16:53:04.778 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.GetAll (PromoPilot.API)'
2025-09-26 16:53:04.781 +05:30 [INF] Request processed successfully.
2025-09-26 16:53:04.785 +05:30 [INF] HTTP GET /api/ExecutionStatus responded 200 in 5659.8546 ms
2025-09-26 16:53:04.799 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/ExecutionStatus - 200 null application/json; charset=utf-8 5680.4296ms
2025-09-26 16:53:47.660 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/ExecutionStatus/1 - null null
2025-09-26 16:53:47.680 +05:30 [INF] Processing request: /api/ExecutionStatus/1
2025-09-26 16:53:47.686 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.GetById (PromoPilot.API)'
2025-09-26 16:53:47.712 +05:30 [INF] Route matched with {action = "GetById", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:53:47.757 +05:30 [INF] Fetching execution status with ID: 1
2025-09-26 16:53:47.765 +05:30 [INF] Fetching execution status with ID: 1
2025-09-26 16:53:48.179 +05:30 [INF] Executed DbCommand (233ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[StatusID], [e].[CampaignID], [e].[Feedback], [e].[Status], [e].[StoreID]
FROM [ExecutionStatus] AS [e]
WHERE [e].[StatusID] = @__p_0
2025-09-26 16:53:48.187 +05:30 [WRN] Execution status with ID 1 not found.
2025-09-26 16:53:48.193 +05:30 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-26 16:53:48.214 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.GetById (PromoPilot.API) in 494.4727ms
2025-09-26 16:53:48.216 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.GetById (PromoPilot.API)'
2025-09-26 16:53:48.218 +05:30 [INF] Request processed successfully.
2025-09-26 16:53:48.218 +05:30 [INF] HTTP GET /api/ExecutionStatus/1 responded 404 in 541.6140 ms
2025-09-26 16:53:48.222 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/ExecutionStatus/1 - 404 null application/problem+json; charset=utf-8 561.3172ms
2025-09-26 16:54:16.564 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/ExecutionStatus/4 - null null
2025-09-26 16:54:16.571 +05:30 [INF] Processing request: /api/ExecutionStatus/4
2025-09-26 16:54:16.573 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.GetById (PromoPilot.API)'
2025-09-26 16:54:16.575 +05:30 [INF] Route matched with {action = "GetById", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetById(Int32) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:54:16.587 +05:30 [INF] Fetching execution status with ID: 4
2025-09-26 16:54:16.589 +05:30 [INF] Fetching execution status with ID: 4
2025-09-26 16:54:16.712 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[StatusID], [e].[CampaignID], [e].[Feedback], [e].[Status], [e].[StoreID]
FROM [ExecutionStatus] AS [e]
WHERE [e].[StatusID] = @__p_0
2025-09-26 16:54:16.718 +05:30 [INF] Executing OkObjectResult, writing value of type 'ExecutionStatusDto'.
2025-09-26 16:54:16.720 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.GetById (PromoPilot.API) in 143.1306ms
2025-09-26 16:54:16.721 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.GetById (PromoPilot.API)'
2025-09-26 16:54:16.723 +05:30 [INF] Request processed successfully.
2025-09-26 16:54:16.724 +05:30 [INF] HTTP GET /api/ExecutionStatus/4 responded 200 in 153.3814 ms
2025-09-26 16:54:16.727 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/ExecutionStatus/4 - 200 null application/json; charset=utf-8 163.3445ms
2025-09-26 16:54:48.590 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/ExecutionStatus - application/json 123
2025-09-26 16:54:48.599 +05:30 [INF] CORS policy execution successful.
2025-09-26 16:54:48.603 +05:30 [INF] Processing request: /api/ExecutionStatus
2025-09-26 16:54:48.604 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Add (PromoPilot.API)'
2025-09-26 16:54:48.613 +05:30 [INF] Route matched with {action = "Add", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(ExecutionStatusDto) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:54:48.664 +05:30 [INF] Creating new execution status.
2025-09-26 16:54:48.669 +05:30 [INF] Adding new execution status.
2025-09-26 16:54:48.859 +05:30 [INF] Executed DbCommand (55ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ExecutionStatus] ([CampaignID], [Feedback], [Status], [StoreID])
OUTPUT INSERTED.[StatusID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 16:54:48.898 +05:30 [ERR] An exception occurred in the database while saving changes for context type 'PromoPilot.Infrastructure.Data.PromoPilotDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ExecutionStatus_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:3849d88b-f4ad-4f32-82ae-29bb03c4720c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ExecutionStatus_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:3849d88b-f4ad-4f32-82ae-29bb03c4720c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-09-26 16:54:49.237 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.Add (PromoPilot.API) in 620.3949ms
2025-09-26 16:54:49.240 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Add (PromoPilot.API)'
2025-09-26 16:54:49.367 +05:30 [ERR] Unhandled exception occurred while processing request: /api/ExecutionStatus
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): The INSERT statement conflicted with the FOREIGN KEY constraint "FK_ExecutionStatus_Campaign_CampaignID". The conflict occurred in database "PromoPilotDB", table "dbo.Campaign", column 'CampaignID'.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:3849d88b-f4ad-4f32-82ae-29bb03c4720c
Error Number:547,State:0,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetAsync(Int32 startCommandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalDatabase.SaveChangesAsync(IList`1 entries, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at PromoPilot.Infrastructure.Repositories.ExecutionStatusRepository.AddAsync(ExecutionStatus status) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Infrastructure\Repositories\ExecutionStatusRepository.cs:line 23
   at PromoPilot.Application.Services.ExecutionStatusService.AddAsync(ExecutionStatus status) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\Services\ExecutionStatusService.cs:line 34
   at PromoPilot.Application.UseCases.ExecutionStatuses.CreateExecutionStatusUseCase.ExecuteAsync(ExecutionStatusDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.Application\UseCases\ExecutionStatuses\CreateExecutionStatusUseCase.cs:line 27
   at PromoPilot.API.Controllers.ExecutionStatusController.Add(ExecutionStatusDto dto) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Controllers\ExecutionStatusController.cs:line 77
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(ActionContext actionContext, IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|7_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at ExceptionHandlingMiddleware.InvokeAsync(HttpContext context) in C:\Users\2436730\source\repos\PromoPilot\PromoPilot.API\Middleware\ExceptionHandlingMiddleware.cs:line 23
2025-09-26 16:54:49.458 +05:30 [ERR] HTTP POST /api/ExecutionStatus responded 500 in 863.0074 ms
2025-09-26 16:54:49.462 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/ExecutionStatus - 500 null application/json 872.1375ms
2025-09-26 16:55:02.683 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/ExecutionStatus - application/json 123
2025-09-26 16:55:02.692 +05:30 [INF] CORS policy execution successful.
2025-09-26 16:55:02.694 +05:30 [INF] Processing request: /api/ExecutionStatus
2025-09-26 16:55:02.699 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Add (PromoPilot.API)'
2025-09-26 16:55:02.703 +05:30 [INF] Route matched with {action = "Add", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Add(ExecutionStatusDto) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:55:02.717 +05:30 [INF] Creating new execution status.
2025-09-26 16:55:02.722 +05:30 [INF] Adding new execution status.
2025-09-26 16:55:02.742 +05:30 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [ExecutionStatus] ([CampaignID], [Feedback], [Status], [StoreID])
OUTPUT INSERTED.[StatusID]
VALUES (@p0, @p1, @p2, @p3);
2025-09-26 16:55:02.789 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'ExecutionStatusDto'.
2025-09-26 16:55:02.825 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.Add (PromoPilot.API) in 110.9632ms
2025-09-26 16:55:02.829 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Add (PromoPilot.API)'
2025-09-26 16:55:02.831 +05:30 [INF] Request processed successfully.
2025-09-26 16:55:02.832 +05:30 [INF] HTTP POST /api/ExecutionStatus responded 201 in 141.0367 ms
2025-09-26 16:55:02.837 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/ExecutionStatus - 201 null application/json; charset=utf-8 154.476ms
2025-09-26 16:55:50.699 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/ExecutionStatus/1 - application/json 122
2025-09-26 16:55:50.716 +05:30 [INF] CORS policy execution successful.
2025-09-26 16:55:50.721 +05:30 [INF] Processing request: /api/ExecutionStatus/1
2025-09-26 16:55:50.726 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API)'
2025-09-26 16:55:50.741 +05:30 [INF] Route matched with {action = "Update", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExecutionStatusDto) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:55:50.753 +05:30 [INF] Updating execution status with ID: 1
2025-09-26 16:55:50.759 +05:30 [INF] Fetching execution status with ID: 1
2025-09-26 16:55:50.812 +05:30 [INF] Executed DbCommand (42ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[StatusID], [e].[CampaignID], [e].[Feedback], [e].[Status], [e].[StoreID]
FROM [ExecutionStatus] AS [e]
WHERE [e].[StatusID] = @__p_0
2025-09-26 16:55:50.816 +05:30 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-26 16:55:50.820 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API) in 72.3135ms
2025-09-26 16:55:50.822 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API)'
2025-09-26 16:55:50.825 +05:30 [INF] Request processed successfully.
2025-09-26 16:55:50.826 +05:30 [INF] HTTP PUT /api/ExecutionStatus/1 responded 404 in 109.9419 ms
2025-09-26 16:55:50.829 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/ExecutionStatus/1 - 404 null application/problem+json; charset=utf-8 130.2102ms
2025-09-26 16:56:11.370 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/ExecutionStatus/4 - application/json 122
2025-09-26 16:56:11.380 +05:30 [INF] CORS policy execution successful.
2025-09-26 16:56:11.382 +05:30 [INF] Processing request: /api/ExecutionStatus/4
2025-09-26 16:56:11.384 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API)'
2025-09-26 16:56:11.387 +05:30 [INF] Route matched with {action = "Update", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExecutionStatusDto) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:56:11.393 +05:30 [INF] Updating execution status with ID: 4
2025-09-26 16:56:11.395 +05:30 [INF] Fetching execution status with ID: 4
2025-09-26 16:56:11.404 +05:30 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[StatusID], [e].[CampaignID], [e].[Feedback], [e].[Status], [e].[StoreID]
FROM [ExecutionStatus] AS [e]
WHERE [e].[StatusID] = @__p_0
2025-09-26 16:56:11.419 +05:30 [INF] Updating execution status with ID: 4
2025-09-26 16:56:11.444 +05:30 [INF] Executed DbCommand (16ms) [Parameters=[@p4='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [ExecutionStatus] SET [CampaignID] = @p0, [Feedback] = @p1, [Status] = @p2, [StoreID] = @p3
OUTPUT 1
WHERE [StatusID] = @p4;
2025-09-26 16:56:11.456 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-26 16:56:11.458 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API) in 66.7912ms
2025-09-26 16:56:11.460 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API)'
2025-09-26 16:56:11.461 +05:30 [INF] Request processed successfully.
2025-09-26 16:56:11.462 +05:30 [INF] HTTP PUT /api/ExecutionStatus/4 responded 204 in 81.3626 ms
2025-09-26 16:56:11.464 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/ExecutionStatus/4 - 204 null null 96.9511ms
2025-09-26 16:56:21.986 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/ExecutionStatus/4 - application/json 122
2025-09-26 16:56:21.989 +05:30 [INF] CORS policy execution successful.
2025-09-26 16:56:21.990 +05:30 [INF] Processing request: /api/ExecutionStatus/4
2025-09-26 16:56:21.991 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API)'
2025-09-26 16:56:21.993 +05:30 [INF] Route matched with {action = "Update", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExecutionStatusDto) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:56:21.996 +05:30 [INF] Updating execution status with ID: 4
2025-09-26 16:56:22.010 +05:30 [INF] Fetching execution status with ID: 4
2025-09-26 16:56:22.019 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[StatusID], [e].[CampaignID], [e].[Feedback], [e].[Status], [e].[StoreID]
FROM [ExecutionStatus] AS [e]
WHERE [e].[StatusID] = @__p_0
2025-09-26 16:56:22.025 +05:30 [INF] Updating execution status with ID: 4
2025-09-26 16:56:22.030 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@p4='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [ExecutionStatus] SET [CampaignID] = @p0, [Feedback] = @p1, [Status] = @p2, [StoreID] = @p3
OUTPUT 1
WHERE [StatusID] = @p4;
2025-09-26 16:56:22.032 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-26 16:56:22.033 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API) in 38.5787ms
2025-09-26 16:56:22.034 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API)'
2025-09-26 16:56:22.036 +05:30 [INF] Request processed successfully.
2025-09-26 16:56:22.036 +05:30 [INF] HTTP PUT /api/ExecutionStatus/4 responded 204 in 47.8411 ms
2025-09-26 16:56:22.038 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/ExecutionStatus/4 - 204 null null 52.1011ms
2025-09-26 16:56:35.456 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/ExecutionStatus/2 - application/json 122
2025-09-26 16:56:35.477 +05:30 [INF] CORS policy execution successful.
2025-09-26 16:56:35.478 +05:30 [INF] Processing request: /api/ExecutionStatus/2
2025-09-26 16:56:35.480 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API)'
2025-09-26 16:56:35.483 +05:30 [INF] Route matched with {action = "Update", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExecutionStatusDto) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:56:35.487 +05:30 [INF] Updating execution status with ID: 2
2025-09-26 16:56:35.489 +05:30 [INF] Fetching execution status with ID: 2
2025-09-26 16:56:35.497 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[StatusID], [e].[CampaignID], [e].[Feedback], [e].[Status], [e].[StoreID]
FROM [ExecutionStatus] AS [e]
WHERE [e].[StatusID] = @__p_0
2025-09-26 16:56:35.500 +05:30 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-26 16:56:35.503 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API) in 16.8051ms
2025-09-26 16:56:35.506 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API)'
2025-09-26 16:56:35.508 +05:30 [INF] Request processed successfully.
2025-09-26 16:56:35.509 +05:30 [INF] HTTP PUT /api/ExecutionStatus/2 responded 404 in 31.8719 ms
2025-09-26 16:56:35.512 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/ExecutionStatus/2 - 404 null application/problem+json; charset=utf-8 55.2753ms
2025-09-26 16:56:55.146 +05:30 [INF] Request starting HTTP/1.1 PUT http://localhost:5145/api/ExecutionStatus/8 - application/json 122
2025-09-26 16:56:55.150 +05:30 [INF] CORS policy execution successful.
2025-09-26 16:56:55.152 +05:30 [INF] Processing request: /api/ExecutionStatus/8
2025-09-26 16:56:55.153 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API)'
2025-09-26 16:56:55.154 +05:30 [INF] Route matched with {action = "Update", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Update(Int32, ExecutionStatusDto) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:56:55.159 +05:30 [INF] Updating execution status with ID: 8
2025-09-26 16:56:55.161 +05:30 [INF] Fetching execution status with ID: 8
2025-09-26 16:56:55.168 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[StatusID], [e].[CampaignID], [e].[Feedback], [e].[Status], [e].[StoreID]
FROM [ExecutionStatus] AS [e]
WHERE [e].[StatusID] = @__p_0
2025-09-26 16:56:55.171 +05:30 [INF] Updating execution status with ID: 8
2025-09-26 16:56:55.180 +05:30 [INF] Executed DbCommand (6ms) [Parameters=[@p4='?' (DbType = Int32), @p0='?' (DbType = Int32), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
UPDATE [ExecutionStatus] SET [CampaignID] = @p0, [Feedback] = @p1, [Status] = @p2, [StoreID] = @p3
OUTPUT 1
WHERE [StatusID] = @p4;
2025-09-26 16:56:55.183 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-26 16:56:55.185 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API) in 26.0463ms
2025-09-26 16:56:55.187 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Update (PromoPilot.API)'
2025-09-26 16:56:55.188 +05:30 [INF] Request processed successfully.
2025-09-26 16:56:55.189 +05:30 [INF] HTTP PUT /api/ExecutionStatus/8 responded 204 in 39.3702 ms
2025-09-26 16:56:55.191 +05:30 [INF] Request finished HTTP/1.1 PUT http://localhost:5145/api/ExecutionStatus/8 - 204 null null 45.275ms
2025-09-26 16:57:31.899 +05:30 [INF] Request starting HTTP/1.1 DELETE http://localhost:5145/api/ExecutionStatus/1 - null null
2025-09-26 16:57:31.918 +05:30 [INF] CORS policy execution successful.
2025-09-26 16:57:31.921 +05:30 [INF] Processing request: /api/ExecutionStatus/1
2025-09-26 16:57:31.925 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Delete (PromoPilot.API)'
2025-09-26 16:57:31.936 +05:30 [INF] Route matched with {action = "Delete", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:57:31.945 +05:30 [INF] Deleting execution status with ID: 1
2025-09-26 16:57:31.951 +05:30 [INF] Fetching execution status with ID: 1
2025-09-26 16:57:31.958 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[StatusID], [e].[CampaignID], [e].[Feedback], [e].[Status], [e].[StoreID]
FROM [ExecutionStatus] AS [e]
WHERE [e].[StatusID] = @__p_0
2025-09-26 16:57:31.967 +05:30 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2025-09-26 16:57:31.970 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.Delete (PromoPilot.API) in 26.6166ms
2025-09-26 16:57:31.972 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Delete (PromoPilot.API)'
2025-09-26 16:57:31.973 +05:30 [INF] Request processed successfully.
2025-09-26 16:57:31.974 +05:30 [INF] HTTP DELETE /api/ExecutionStatus/1 responded 404 in 56.0645 ms
2025-09-26 16:57:31.979 +05:30 [INF] Request finished HTTP/1.1 DELETE http://localhost:5145/api/ExecutionStatus/1 - 404 null application/problem+json; charset=utf-8 79.9706ms
2025-09-26 16:57:37.943 +05:30 [INF] Request starting HTTP/1.1 DELETE http://localhost:5145/api/ExecutionStatus/4 - null null
2025-09-26 16:57:37.950 +05:30 [INF] CORS policy execution successful.
2025-09-26 16:57:37.952 +05:30 [INF] Processing request: /api/ExecutionStatus/4
2025-09-26 16:57:37.954 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Delete (PromoPilot.API)'
2025-09-26 16:57:37.956 +05:30 [INF] Route matched with {action = "Delete", controller = "ExecutionStatus"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Delete(Int32) on controller PromoPilot.API.Controllers.ExecutionStatusController (PromoPilot.API).
2025-09-26 16:57:37.959 +05:30 [INF] Deleting execution status with ID: 4
2025-09-26 16:57:37.967 +05:30 [INF] Fetching execution status with ID: 4
2025-09-26 16:57:37.971 +05:30 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [e].[StatusID], [e].[CampaignID], [e].[Feedback], [e].[Status], [e].[StoreID]
FROM [ExecutionStatus] AS [e]
WHERE [e].[StatusID] = @__p_0
2025-09-26 16:57:37.978 +05:30 [INF] Deleting execution status with ID: 4
2025-09-26 16:57:37.990 +05:30 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
DELETE FROM [ExecutionStatus]
OUTPUT 1
WHERE [StatusID] = @p0;
2025-09-26 16:57:37.996 +05:30 [INF] Executing StatusCodeResult, setting HTTP status code 204
2025-09-26 16:57:37.997 +05:30 [INF] Executed action PromoPilot.API.Controllers.ExecutionStatusController.Delete (PromoPilot.API) in 38.251ms
2025-09-26 16:57:37.998 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.ExecutionStatusController.Delete (PromoPilot.API)'
2025-09-26 16:57:37.999 +05:30 [INF] Request processed successfully.
2025-09-26 16:57:38.000 +05:30 [INF] HTTP DELETE /api/ExecutionStatus/4 responded 204 in 50.5356 ms
2025-09-26 16:57:38.002 +05:30 [INF] Request finished HTTP/1.1 DELETE http://localhost:5145/api/ExecutionStatus/4 - 204 null null 58.6491ms
2025-09-26 16:59:25.881 +05:30 [INF] Request starting HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - application/json 151
2025-09-26 16:59:25.904 +05:30 [INF] CORS policy execution successful.
2025-09-26 16:59:25.905 +05:30 [INF] Processing request: /api/Campaign/plan
2025-09-26 16:59:25.909 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 16:59:25.917 +05:30 [INF] Route matched with {action = "PlanCampaign", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] PlanCampaign(PromoPilot.Application.DTOs.CampaignDto) on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 16:59:25.992 +05:30 [INF] Executed DbCommand (18ms) [Parameters=[@__name_0='?' (Size = 4000), @__start_1='?' (DbType = DateTime2), @__end_2='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
WHERE [c].[Name] = @__name_0 AND [c].[StartDate] = @__start_1 AND [c].[EndDate] = @__end_2
2025-09-26 16:59:26.117 +05:30 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000)], CommandType='"Text"', CommandTimeout='30']
SET IMPLICIT_TRANSACTIONS OFF;
SET NOCOUNT ON;
INSERT INTO [Campaign] ([EndDate], [Name], [StartDate], [StoreList], [TargetProducts])
OUTPUT INSERTED.[CampaignID]
VALUES (@p0, @p1, @p2, @p3, @p4);
2025-09-26 16:59:26.129 +05:30 [INF] Executing CreatedAtActionResult, writing value of type 'PromoPilot.Application.DTOs.CampaignDto'.
2025-09-26 16:59:26.136 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API) in 213.0211ms
2025-09-26 16:59:26.140 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.PlanCampaign (PromoPilot.API)'
2025-09-26 16:59:26.141 +05:30 [INF] Request processed successfully.
2025-09-26 16:59:26.142 +05:30 [INF] HTTP POST /api/Campaign/plan responded 201 in 238.1044 ms
2025-09-26 16:59:26.145 +05:30 [INF] Request finished HTTP/1.1 POST http://localhost:5145/api/Campaign/plan - 201 null application/json; charset=utf-8 263.97ms
2025-09-26 16:59:39.065 +05:30 [INF] Request starting HTTP/1.1 GET http://localhost:5145/api/Campaign - null null
2025-09-26 16:59:39.071 +05:30 [INF] Processing request: /api/Campaign
2025-09-26 16:59:39.072 +05:30 [INF] Executing endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 16:59:39.079 +05:30 [INF] Route matched with {action = "GetAllCampaigns", controller = "Campaign"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] GetAllCampaigns() on controller PromoPilot.API.Controllers.CampaignController (PromoPilot.API).
2025-09-26 16:59:39.118 +05:30 [INF] Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT [c].[CampaignID], [c].[EndDate], [c].[Name], [c].[StartDate], [c].[StoreList], [c].[TargetProducts]
FROM [Campaign] AS [c]
2025-09-26 16:59:39.141 +05:30 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[PromoPilot.Application.DTOs.CampaignDto, PromoPilot.Application, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2025-09-26 16:59:39.145 +05:30 [INF] Executed action PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API) in 58.3413ms
2025-09-26 16:59:39.149 +05:30 [INF] Executed endpoint 'PromoPilot.API.Controllers.CampaignController.GetAllCampaigns (PromoPilot.API)'
2025-09-26 16:59:39.150 +05:30 [INF] Request processed successfully.
2025-09-26 16:59:39.151 +05:30 [INF] HTTP GET /api/Campaign responded 200 in 81.1441 ms
2025-09-26 16:59:39.155 +05:30 [INF] Request finished HTTP/1.1 GET http://localhost:5145/api/Campaign - 200 null application/json; charset=utf-8 89.454ms
